(this["webpackJsonpweather-app"]=this["webpackJsonpweather-app"]||[]).push([[0],{23:function(t,e,n){},24:function(t,e,n){},31:function(t,e,n){"use strict";n.r(e);var a,i,r,c,o,s,d,l,p,m,h,u,g,j,x,b,f=n(1),O=n.n(f),w=n(15),v=n.n(w),y=(n(23),n(7)),S=n(3),D=(n(24),n(4)),M=n.p+"static/media/spinner.e558538c.svg",k=n(0),L=D.b.div(a||(a=Object(S.a)(["\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: center;\n\talign-items: center;\n"]))),I=D.b.img(i||(i=Object(S.a)(["\n\twidth: 80px;\n\theight: 80px;\n\n\tstroke: #ccc;\n\n\tanimation: spin 1s linear infinite;\n\n\t@keyframes spin {\n\t\t100% {\n\t\t\ttransform: rotate(360deg);\n\t\t}\n\t}\n"]))),R=function(t){var e=t.error;return Object(k.jsxs)(L,{children:[Object(k.jsx)(I,{src:M,alt:""}),e?Object(k.jsx)("div",{children:e}):Object(k.jsx)(k.Fragment,{})]})},J=n(5),N=n(6),F=D.b.div(r||(r=Object(S.a)(["\n\tdisplay: grid;\n\tgrid-template-columns: 1fr;\n\tgrid-template-rows: auto 1fr 1fr 1fr;\n\n\tpadding: 8px;\n\tmargin: 8px;\n\n\tborder-radius: 4px;\n\tbox-shadow: var(--border-shadow);\n\n\ttransition: 0.2s ease;\n\n\t&:hover {\n\t\tbox-shadow: var(--small-shadow);\n\t}\n\n\t// Small devices (landscape phones, 576px and up)\n\t@media (min-width: 576px) {\n\t\tgrid-template-columns: 1fr 1fr;\n\t\tgrid-template-rows: auto 1fr 1fr;\n\t}\n\n\t// Medium devices (tablets, 768px and up)\n\t@media (min-width: 768px) {\n\t}\n\n\t// Large devices (desktops, 992px and up)\n\t@media (min-width: 992px) {\n\t\tgrid-template-columns: 1fr 1fr;\n\t\tgrid-template-rows: auto 1fr 1fr;\n\t}\n"]))),P=D.b.div(c||(c=Object(S.a)(["\n\tdisplay: flex;\n\tjustify-content: space-between;\n\n\t// Small devices (landscape phones, 576px and up)\n\t@media (min-width: 576px) {\n\t\tgrid-column: span 2;\n\t}\n\n\t// Medium devices (tablets, 768px and up)\n\t@media (min-width: 768px) {\n\t}\n\n\t// Large devices (desktops, 992px and up)\n\t@media (min-width: 992px) {\n\t}\n"]))),T=D.b.div(o||(o=Object(S.a)(["\n\tdisplay: flex;\n"]))),U=D.b.div(s||(s=Object(S.a)(["\n\theight: fit-content;\n\n\tmargin: 0 0 0 8px;\n\tpadding: 0;\n\n\tborder: none;\n\tbackground: none;\n\tcolor: var(--text);\n\tfont-size: 1em;\n\n\tcursor: pointer;\n\tpointer-events: initial;\n\n\topacity: ",";\n\tpointer-events: ",";\n"])),(function(t){return t.disabled?"0.1":"1"}),(function(t){return t.disabled?"none":"auto"})),C=D.b.div(d||(d=Object(S.a)(["\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: center;\n\talign-items: center;\n\n\t// Small devices (landscape phones, 576px and up)\n\t@media (min-width: 576px) {\n\t\tgrid-column: span 2;\n\t}\n\n\t// Medium devices (tablets, 768px and up)\n\t@media (min-width: 768px) {\n\t}\n\n\t// Large devices (desktops, 992px and up)\n\t@media (min-width: 992px) {\n\t\tgrid-column: span 2;\n\t}\n"]))),A=D.b.div(l||(l=Object(S.a)(["\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\n\tfont-size: 6rem;\n\tfont-weight: 700;\n"]))),B=D.b.div(p||(p=Object(S.a)(["\n\tjustify-self: stretch;\n\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: center;\n\talign-items: center;\n\n\t// Medium devices (tablets, 768px and up)\n\t@media (min-width: 768px) {\n\t\tjustify-content: center;\n\t\talign-items: unset;\n\t\tmin-width: 256px;\n\t}\n\n\t// Large devices (desktops, 992px and up)\n\t@media (min-width: 992px) {\n\t\tmin-width: 256px;\n\t}\n"]))),W=function(t){for(var e=t.convertTime,n=t.daysArray,a=t.forceRefetch,i=t.forceRefresh,r=t.iconURL,c=t.weatherData,o=0,s=[],d=[],l=0;l<n[0].length;l++)o+=n[0][l].pop,s.push(n[0][l].main.temp_min),d.push(n[0][l].main.temp_max);var p={clouds:c.clouds.all,date:c.dt,description:c.weather[0].description,feelsLike:Math.round(c.main.feels_like),humidity:c.main.humidity,image:c.weather[0].icon,imageCode:c.weather[0].id,lastUpdated:c.dt,pop:Math.round(o/n[0].length*100),pressure:c.main.pressure,main:c.weather[0].main,sunrise:c.sys.sunrise,sunset:c.sys.sunset,temp:Math.round(c.main.temp),tempMin:Math.round(Math.min.apply(Math,s)),tempMax:Math.round(Math.max.apply(Math,d)),visibility:Math.floor(c.visibility/1e3),windSpeed:c.wind.speed,windDeg:c.wind.deg};return Object(k.jsxs)(F,{children:[Object(k.jsxs)(P,{children:[Object(k.jsxs)("div",{children:[Object(k.jsx)(J.a,{icon:N.g,title:"Location"})," ",c.name,",",c.sys.country]}),Object(k.jsxs)(T,{title:a?"Next refresh in 5 min":"",children:[Object(k.jsxs)("div",{children:[Object(k.jsx)(J.a,{icon:N.c,title:"Last updated"})," ",e(c.dt)]}),Object(k.jsx)(U,{onClick:i,disabled:!!a,title:"Refresh",children:Object(k.jsx)(J.a,{icon:N.j})})]})]}),Object(k.jsxs)(C,{children:[Object(k.jsx)("img",{src:"".concat(r,"/").concat(p.image,"@2x.png"),alt:p.description}),Object(k.jsx)(A,{children:Object(k.jsxs)("div",{children:[p.temp,"\xb0"]})})]}),Object(k.jsxs)(B,{children:[Object(k.jsxs)("div",{children:[Object(k.jsx)(J.a,{icon:N.l,title:"Low"})," ",p.tempMin,"\xb0 / ",Object(k.jsx)(J.a,{icon:N.k,title:"High"})," ",p.tempMax,"\xb0"]}),Object(k.jsxs)("div",{children:[Object(k.jsx)(J.a,{icon:N.m,title:"Feels like"})," Feels like ",p.feelsLike,"\xb0"]}),Object(k.jsxs)("div",{children:[Object(k.jsx)(J.a,{icon:N.d,title:"Cloud coverage"})," Cloud coverage: ",p.clouds,"%"]}),Object(k.jsxs)("div",{children:[Object(k.jsx)(J.a,{icon:N.o,title:"Probability of precipitation"})," ","Precipitation: ",p.pop,"%"]}),Object(k.jsxs)("div",{children:[Object(k.jsx)(J.a,{icon:N.n,title:"Humidity"})," Humidity:"," ",p.humidity,"%"]})]}),Object(k.jsxs)(B,{children:[Object(k.jsxs)("div",{children:[Object(k.jsx)(J.a,{icon:N.f,title:"Atmospheric pressure"})," ","Pressure: ",p.pressure,"hPa"]}),Object(k.jsxs)("div",{children:[Object(k.jsx)(J.a,{icon:N.b,title:"Visibility"})," Visibility:"," ",p.visibility,"km"]}),Object(k.jsxs)("div",{children:[Object(k.jsx)(J.a,{icon:N.p,title:"Wind speed/direction"})," Wind:"," ",p.windSpeed,"m/s"," ",Object(k.jsx)(J.a,{icon:N.a,transform:{rotate:p.windDeg},title:"Wind direction"})]}),Object(k.jsxs)("div",{children:[Object(k.jsx)(J.a,{icon:N.i,title:"Sunrise"})," Sunrise:"," ",e(p.sunrise)]}),Object(k.jsxs)("div",{children:[Object(k.jsx)(J.a,{icon:N.h,title:"Sunset"})," Sunset:"," ",e(p.sunset)]})]})]})},H=D.b.div(m||(m=Object(S.a)(["\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\n\tborder-radius: 4px;\n\tbox-shadow: var(--border-shadow);\n\n\tpadding: 8px;\n\tmargin: 8px;\n\n\ttransition: 0.2s ease;\n\n\timg {\n\t\tmax-width: 100px;\n\t\theight: auto;\n\t}\n\n\t&:hover {\n\t\tbox-shadow: var(--small-shadow);\n\t}\n"]))),z=D.b.div(h||(h=Object(S.a)(["\n\tdisplay: flex;\n\n\tdiv {\n\t\tmargin: 0 2px;\n\t}\n"]))),E=function(t){var e=t.iconURL,n=t.item,a=t.timeOrDate;return Object(k.jsxs)(H,{children:[Object(k.jsx)("div",{children:a(n.date)}),Object(k.jsx)("img",{src:"".concat(e,"/").concat(n.image,"@2x.png"),alt:n.description}),Object(k.jsxs)("div",{children:[Math.round(n.temp),"\xb0 \u2013 ",n.main]}),Object(k.jsxs)(z,{children:[n.clouds>10?Object(k.jsxs)("div",{children:[Object(k.jsx)(J.a,{icon:N.d,title:"Cloud coverage"})," ",n.clouds,"%"]}):Object(k.jsx)(k.Fragment,{}),n.pop>0?Object(k.jsxs)("div",{children:[Object(k.jsx)(J.a,{icon:N.e,title:"Probability of precipitation"})," ",n.pop,"%"]}):Object(k.jsx)(k.Fragment,{})]})]})},_=D.b.div(u||(u=Object(S.a)(["\n\tdisplay: grid;\n\tgrid-template-rows: repeat(4, 1fr);\n\tgrid-template-columns: initial;\n\n\tmargin: 0;\n\tpadding: 0;\n\n\t// Small devices (landscape phones, 576px and up)\n\t@media (min-width: 576px) {\n\t\tgrid-template-rows: repeat(2, 1fr);\n\t\tgrid-template-columns: repeat(2, 1fr);\n\t}\n\n\t// Large devices (desktops, 992px and up)\n\t@media (min-width: 992px) {\n\t\tgrid-template-rows: initial;\n\t\tgrid-template-columns: repeat(4, 1fr);\n\t}\n"]))),G=function(t){for(var e=t.convertTime,n=t.forecastData,a=t.iconURL,i=[],r=0;r<5;r++){var c={clouds:n.list[r].clouds.all,date:n.list[r].dt,description:n.list[r].weather[0].description,image:n.list[r].weather[0].icon,pop:Math.round(100*n.list[r].pop),main:n.list[r].weather[0].main,temp:Math.round(n.list[r].main.temp)};i.push(c)}return Object(k.jsx)(_,{children:i.slice(0,4).map((function(t,n){return Object(k.jsx)(E,{timeOrDate:e,item:t,iconURL:a},n)}))})},V=D.b.div(g||(g=Object(S.a)(["\n\tdisplay: grid;\n\tgrid-template-columns: initial;\n\tgrid-template-rows: repeat(4, 1fr);\n\n\tmargin: 0;\n\tpadding: 0;\n\n\t// Small devices (landscape phones, 576px and up)\n\t@media (min-width: 576px) {\n\t\tgrid-template-rows: repeat(2, 1fr);\n\t\tgrid-template-columns: repeat(2, 1fr);\n\t}\n\n\t// Large devices (desktops, 992px and up)\n\t@media (min-width: 992px) {\n\t\tgrid-template-columns: repeat(4, 1fr);\n\t\tgrid-template-rows: initial;\n\t}\n"]))),Y=function(t){for(var e=t.daysArray,n=t.convertDate,a=t.iconURL,i=[],r=1;r<6;r++){for(var c=0,o=0,s=0,d=0;d<e[r].length;d++)c+=e[r][d].clouds.all,o+=e[r][d].pop,s+=e[r][d].main.temp;var l={clouds:Math.round(c/e[r].length),date:e[r][Math.ceil(e[r].length/2)].dt,description:e[r][Math.ceil(e[r].length/2)].weather[0].description,image:e[r][Math.ceil(e[r].length/2)].weather[0].icon.substring(0,e[r][Math.ceil(e[r].length/2)].weather[0].icon.length-1)+"d",pop:Math.round(o/e[r].length*100),main:e[r][Math.ceil(e[r].length/2)].weather[0].main,temp:Math.round(s/e[r].length)};i.push(l)}return Object(k.jsx)(V,{children:i.slice(0,4).map((function(t,e){return Object(k.jsx)(E,{timeOrDate:n,item:t,iconURL:a},e)}))})},$=D.b.div(j||(j=Object(S.a)([""]))),q=function(t){for(var e=t.convertDate,n=t.convertTime,a=t.forceRefetch,i=t.forceRefresh,r=t.forecastData,c=t.weatherData,o="http://openweathermap.org/img/wn",s=[],d=function(t){var e=(new Date).setFullYear((new Date).getFullYear(),0,1),n=Math.floor(e/864e5);return Math.ceil(t.getTime()/864e5)-n},l=function(t){s.push(r.list.filter((function(e){return d(new Date(1e3*e.dt))===d(new Date)+t})))},p=0;p<6;p++)l(p);return Object(k.jsxs)($,{children:[Object(k.jsx)(W,{convertDate:e,convertTime:n,daysArray:s,forceRefetch:a,forceRefresh:i,iconURL:o,weatherData:c}),Object(k.jsx)(G,{convertTime:n,forecastData:r,iconURL:o}),Object(k.jsx)(Y,{convertDate:e,daysArray:s,iconURL:o})]})},K=Object(D.a)(x||(x=Object(S.a)(["\n  html {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\n    min-height: 100%;\n\n    background-color: var(--background);\n    color: var(--text);\n\n    :root{\n      --border-shadow: 0px 0px 0px 0px rgba(0, 0, 0, 0.1),\n\t\t0px 0px 0px 1px rgba(0, 0, 0, 0.15);\n      --small-shadow: 0px 0px 16px 0px rgba(0, 0, 0, 0.15),\n\t\t\t0px 4px 8px -4px rgba(0, 0, 0, 0.5);\n      --big-shadow: 0px 0px 32px 0px rgba(0, 0, 0, 0.15),\n\t\t\t0px 8px 24px -8px rgba(0, 0, 0, 0.5);\n    }\n\n    // Light theme\n    @media (prefers-color-scheme: light) {\n      :root {\n        --text: #333;\n        --background: #fff;\n      }\n    }\n    // Dark theme\n    @media (prefers-color-scheme: dark) {\n      :root{\n        --text: #ccc;\n        --background: #222;\n      }\n\n      background-color: var(--background);\n      color: var(--text);\n    }\n  }\n\n  body {\n    width: 100%;\n\n    margin: 0;\n\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n      'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n      sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n\n    // Medium devices (tablets, 768px and up)\n    @media (min-width: 768px) {\n      width: unset;\n    }\n  }\n\n  #root{\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n"]))),Q=D.b.div(b||(b=Object(S.a)(["\n\tmargin: 0px;\n\tpadding: 8px;\n\n\twidth: 100%;\n\n\tborder-radius: 8px;\n\tbox-shadow: var(--big-shadow);\n\n\ttransition: 0.2s ease;\n\n\t// Small devices (landscape phones, 576px and up)\n\t@media (min-width: 576px) {\n\t\tmargin: 32px;\n\t}\n\n\t// Medium devices (tablets, 768px and up)\n\t@media (min-width: 768px) {\n\t\tmax-width: 768px;\n\t}\n\n\t// Large devices (desktops, 992px and up)\n\t@media (min-width: 992px) {\n\t\twidth: unset;\n\t\tmax-width: 992px;\n\t}\n"])));var X=function(){var t=Object(f.useState)(null),e=Object(y.a)(t,2),n=e[0],a=e[1],i=Object(f.useState)(),r=Object(y.a)(i,2),c=r[0],o=r[1],s=Object(f.useState)(!1),d=Object(y.a)(s,2),l=d[0],p=d[1],m=Object(f.useState)(),h=Object(y.a)(m,2),u=h[0],g=h[1],j=Object(f.useState)(!1),x=Object(y.a)(j,2),b=x[0],O=x[1],w=Object(f.useState)([]),v=Object(y.a)(w,2),S=v[0],D=v[1],M=Object(f.useState)(!1),L=Object(y.a)(M,2),I=L[0],J=L[1],N=Object(f.useState)([]),F=Object(y.a)(N,2),P=F[0],T=F[1],U=Object(f.useState)(!1),C=Object(y.a)(U,2),A=C[0],B=C[1],W=Object(f.useState)(!1),H=Object(y.a)(W,2),z=H[0],E=H[1],_="https://api.openweathermap.org/data/2.5",G="88f8e8a58d8479319be8c6845d6d1a75";return Object(f.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(t){o(t.coords.latitude),p(!0),g(t.coords.longitude),O(!0)}))})),Object(f.useEffect)((function(){var t=function(){fetch("".concat(_,"/weather/?lat=").concat(c,"&lon=").concat(u,"&units=metric&appid=").concat(G)).then((function(t){return t.json()})).then((function(t){200!==t.cod?a(t.message):(D(t),localStorage.setItem("weatherData",JSON.stringify(t)),console.log("weather",t)),console.log("current weather API called once!")}))},e=function(){fetch("".concat(_,"/forecast?lat=").concat(c,"&lon=").concat(u,"&units=metric&appid=").concat(G)).then((function(t){return t.json()})).then((function(t){"200"!==t.cod?a(t.message):(T(t),localStorage.setItem("forecastData",JSON.stringify(t)),console.log("forecast",t)),console.log("weather forecast API called once!")}))};null===localStorage.getItem("weatherData")||null===localStorage.getItem("forecastData")?l&&b?(console.log("lat and lon loaded, calling API"),e(),t(),J(!0),B(!0)):console.log("need both coordinates"):z?(e(),t(),J(!0),B(!0)):"200"===JSON.parse(localStorage.getItem("forecastData")).cod&&200===JSON.parse(localStorage.getItem("weatherData")).cod?Date.now()-1e3*JSON.parse(localStorage.getItem("weatherData")).dt>72e5?l&&b?(console.log("data age > 2 hours"),console.log("lat and lon loaded, calling API"),t(),e(),J(!0),B(!0)):console.log("need both coordinates"):(D(JSON.parse(localStorage.getItem("weatherData"))),T(JSON.parse(localStorage.getItem("forecastData"))),J(!0),B(!0)):(console.log("weather error",JSON.parse(localStorage.getItem("weatherData")).cod,JSON.parse(localStorage.getItem("weatherData")).message),console.log("forecast error",JSON.parse(localStorage.getItem("forecastData")).cod,JSON.parse(localStorage.getItem("forecastData")).message),a("weather error: ".concat(JSON.parse(localStorage.getItem("weatherData")).message,"\n          forecast error: ").concat(JSON.parse(localStorage.getItem("forecastData")).message))),console.log("effect ran once!")}),[G,_,u,c,l,b,S.dt,z]),Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(K,{}),I&&200===S.cod&&A&&"200"===P.cod?Object(k.jsx)(Q,{children:Object(k.jsx)(q,{convertDate:function(t){return new Date(1e3*t).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"numeric",year:"numeric"})},convertTime:function(t){return new Date(1e3*t).toLocaleTimeString("en-GB",{hour12:!1,hour:"numeric",minute:"numeric"})},forceRefetch:z,forceRefresh:function(){E(!0),console.log("1 refresh per 5 min"),setTimeout((function(){E(!1),console.log("refresh timer finished"),clearTimeout()}),3e5)},forecastData:P,weatherData:S})}):Object(k.jsx)(R,{error:n})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Z=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,32)).then((function(e){var n=e.getCLS,a=e.getFID,i=e.getFCP,r=e.getLCP,c=e.getTTFB;n(t),a(t),i(t),r(t),c(t)}))};v.a.render(Object(k.jsx)(O.a.StrictMode,{children:Object(k.jsx)(X,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)})),Z()}},[[31,1,2]]]);
//# sourceMappingURL=main.86ffafb7.chunk.js.map